## load libraries and source scripts
library(slingshot)
library(inflection)
library(rgl)
library(RColorBrewer)
## load data
adata = readRDS('../../output/slingshot/adata_start_louvain_semisup.rds')
colour_palette = c('#1f77b4',
'#ff7f0e',
'#2ca02c',
'#d62728',
'#9467bd',
'#8c564b',
'#e377c2',
'#7f7f7f')
adata$semisup = as.character(adata$louvain_r1.5)
adata$semisup[!(adata$louvain_r1.5 %in% c("Glia_1","Glia_2"))] = as.character(adata$louvain_semisup[!(adata$louvain_r1.5 %in% c("Glia_1","Glia_2"))])
adata$semisup = as.factor(adata$semisup)
adata$semisup = factor(adata$semisup, levels = c("Early","Early_neurons","Late_1","Late_2","Late_neurons","Adult_neurons",  "Glia_1","Glia_2")
)
library(plyr)
adata$semisup = revalue(adata$semisup, c("Early"="Early", "Early_neurons"="Early neurons","Late_1" = "Late 1",
"Late_2" = "Late 2", "Late_neurons" = "Late neurons","Adult_neurons" = "Adult neurons", "Glia_1" = "Glia 1", "Glia_2" = "Glia 2"))
data = data.frame(PC1 =adata@reducedDims$PCA[,1],PC2 =  adata@reducedDims$PCA[,2], cluster = adata$semisup)
glial_pt = slingCurves(adata)$curve2$s[!(is.na(adata$slingPseudotime_2)),]
glial_pt = glial_pt[order(adata$slingPseudotime_2[!(is.na(adata$slingPseudotime_2))]),]
glial_pt =as.data.frame(glial_pt)
glial_pt$pt = adata$slingPseudotime_2[!(is.na(adata$slingPseudotime_2))][order(adata$slingPseudotime_2[!(is.na(adata$slingPseudotime_2))])]
neural_pt = slingCurves(adata)$curve1$s[!(is.na(adata$slingPseudotime_1)),]
neural_pt = neural_pt[order(adata$slingPseudotime_1[!(is.na(adata$slingPseudotime_1))]),]
neural_pt =as.data.frame(neural_pt)
neural_pt$pt = adata$slingPseudotime_1[!(is.na(adata$slingPseudotime_1))][order(adata$slingPseudotime_1[!(is.na(adata$slingPseudotime_1))])]
neural_early_pt = slingCurves(adata)$curve3$s[!(is.na(adata$slingPseudotime_3)),]
neural_early_pt = neural_early_pt[order(adata$slingPseudotime_3[!(is.na(adata$slingPseudotime_3))]),]
neural_early_pt =as.data.frame(neural_early_pt)
neural_early_pt$pt = adata$slingPseudotime_3[!(is.na(adata$slingPseudotime_3))][order(adata$slingPseudotime_3[!(is.na(adata$slingPseudotime_3))])]
library(extrafont)
font_import(paths = "/usr/share/fonts/truetype/myfonts/",prompt = F)
adata["Wwtr1",]
adata@assays
adata@assays[['X']]
adata['Wwtr1',]@assays[['X']]
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =adata['Wwtr1',]@assays[['X']]),alpha=0.3, size = 3) +
theme_classic() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = '#2ca02c') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "#8c564b", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = '#ff7f0e', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank())
library(ggplot.multistats)
library(ggplot)
library(ggplot2)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =adata['Wwtr1',]@assays[['X']]),alpha=0.3, size = 3) +
theme_classic() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = '#2ca02c') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "#8c564b", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = '#ff7f0e', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank())
print(p)
dim(data)
dim(adata['Wwtr1',]@assays[['X']])
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Wwtr1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = '#2ca02c') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "#8c564b", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = '#ff7f0e', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank())
print(p)
print(p)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Wwtr1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank())
print(p)
library(viridis)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Wwtr1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank())
print(p)
print(p)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Wwtr1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Wwtr1")
print(p)
print(p)
pdf('../../output/pseudotime_Wwtr1.pdf',height = 4, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Wwtr1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Wwtr1")
print(p)
dev.off()
pdf('../../output/pseudotime_Wwtr1.pdf',height = 3.5, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Wwtr1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Wwtr1")
print(p)
dev.off()
pdf('../../output/pseudotime_Wwtr1.pdf',height = 3.75, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Wwtr1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Wwtr1")
print(p)
dev.off()
pdf('../../output/pseudotime_Yap1.pdf',height = 3.75, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Yap1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Yap1")
print(p)
dev.off()
pdf('../../output/pseudotime_Tead1.pdf',height = 3.75, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Tead1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Tead1")
print(p)
dev.off()
pdf('../../output/pseudotime_Tead2.pdf',height = 3.75, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Tead2',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Tead2")
print(p)
dev.off()
pdf('../../output/pseudotime_Tead4.pdf',height = 3.75, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Tead4',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Tead4")
print(p)
dev.off()
pdf('../../output/pseudotime_Smad1.pdf',height = 3.75, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Smad1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Smad1")
print(p)
dev.off()
pdf('../../output/pseudotime_Smad1.pdf',height = 3.75, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Smad1',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Smad1")
print(p)
dev.off()
pdf('../../output/pseudotime_Smad2.pdf',height = 3.75, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Smad2',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Smad2")
print(p)
dev.off()
pdf('../../output/pseudotime_Smad4.pdf',height = 3.75, width = 5)
p = ggplot(data = data, aes(x = PC1,y = PC2)) + geom_point(aes(color =as.numeric(adata['Smad4',]@assays[['X']])),alpha=0.3, size = 3) +
theme_classic() + scale_color_viridis() +
geom_path(data = glial_pt, aes(x = `Dim-1`, y = `Dim-2`,color = pt), size = 1.5, color = 'black') + geom_path(data = neural_pt, aes(x = `Dim-1`, y = `Dim-2`),color = "black", size = 1.5) +  geom_path(data = neural_early_pt, aes(x = `Dim-1`, y = `Dim-2`), color = 'black', size = 1.5)  + theme_classic() + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(axis.text = element_text(family = "Helvetica", color = "black",size = 15)) + theme(legend.title = element_blank()) + ggtitle("Smad4")
print(p)
dev.off()
as.numeric(adata['Smad4',]@assays[['X']])
adata['Smad4',]@assays[['X']]
